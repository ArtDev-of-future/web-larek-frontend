# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание данных

Интерфейс `IItemInit` используется для получения данных с сервера. В поле `total` представлено общее количество элементов. В поле `items` представлен массив элементов.

```typescript
interface IItemInit extends ICustomerSet {
	total: number;
	items: string[];
}
```

Интерфейс `IItemCard` хранит в себе данные о каждой карточке товара. В поле `id` хранится уникальный идентификатор товара. В поле `description` хранится краткое описание товара. В поле `image` хранится ссылка на изображение. В поле `title` хранится название товара. В поле `category` хранится категория товара. В поле `price` хранится цена товара.

```typescript
interface IItemCard {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}
```

Интерфейс `IBasket` хранит в себе массив товаров (`itemCards`), добавленных в корзину. Метод `addItemCard` добавляет новый элемент в массив. Метод `removeItemCard` удаляет элемент из массива.

```typescript
interface IBasket {
	items: HTMLElement[];
	total: number;
	selected: string[];
}
```

Интерфейс `ICustomerSet` хранит в себе данные о введённых покупателем данных. В поле `paymentType` хранится метод оплаты. В поле `address` хранится адрес. В поле `email` хранится электронная почта. В поле `phone` хранится номер телефона. Также интерфейс хранит в себе два метода. Метод `setCustomerInfo` принимает данные, которые указал покупатель. Метод `checkValidation` проверяет введённые данные на валидность.

```typescript
interface ICustomerSet {
	payment: string;
	address: string;
	email: string;
	phone: string;
}
```

Интерфейс `ICard` используется при отображении позиций в корзине.

```typescript
interface ICard extends IItemCard {
	basketId?: string;
	button: string;
}
```

Интерфейс `IAppState` - основной интерфейс приложения. Он хранит в себе различные состояния приложения и его элементы.

```typescript
interface IAppState {
	loading: boolean;
	catalog: IItemCard[];
	preview: string | null;
	basket: IItemCard[];
	order: IItemInit | null;
}
```

Интерфейс `IGetDataApi` - интерфейс для работы с API. Типизируются методы для GET и POST запросов.

```typescript
interface IGetDataApi {
	getData: () => Promise<IItemCard[]>;
	sendOrder: (order: IItemInit) => Promise<IOrder>;
}
```

## Модели данных (Model)

Класс `AppState` - класс состояния приложения.

Класс `Form` - класс ввода данных с валидацией.

Класс `Order` - класс оформления заказа.

## Компоненты представления (View)

Класс `ViewBasket`. Этот компонент отображает страницу корзины.

Класс `Card` . Этот компонент отображает информацию о карточке.

Класс `Modal`. Этот компонент отображает popup.

Класс `ViewPage`. Этот компонент отображает страницу приложения.

Класс `Success`. Этот компонент отображает страницу уведомления об успешном заказе.

## Описание событий

Приложение реализует взаимодействие между слоями Model, View и Presenter с помощью системы событий. Для каждого пользовательского действия генерируется событие, которое проходит через Presenter, обновляет состояние Model и возвращает результат обратно во View.

### Список основных генерируемых событий:

1. `card:select` - событие, генерируемое при клике на карточку товара. Обрабатывается для показа всплывающего окна с деталями товара.
2. `preview:changed` - событие, генерируемое при клике на кнопку внутри карточки товара для изменения этой кнопки.
3. `item:check` - событие, генерируемое при нажатии на кнопку внутри карточки товара, оповещает об изменении корзины.
4. `item:add` - событие, генерируемое при добавлении товара в корзину.
5. `item:remove` - событие, генерируемое при удалении товара из корзины.
6. `basket:changed` - событие, указывающее на изменение внутри корзины.
7. `basket:open` - событие, генерируемое при открытии modal корзины.
8. `order:open` - событие, генерируемое при переходе к вводу параметров заказа.
9. `order:change` - событие, генерируемое при любых действиях внутри окна заказа для валидации данных.
10. `order:submit` - событие генерирует окно ввода данных для связи.
11. `formErrors:change` - валидация.
12. `contacts:submit` - событие отправляет заказ по API и отображает success modal.

### Порядок генерации и обработки событий:

1. Инициализация и подписка на события: Компоненты, такие как ViewBasket, Card, Form, Order, ViewPage и другие, создаются с использованием экземпляра EventEmitter. В процессе инициализации они подписываются на конкретные события через метод `on`.

2. Генерация и передача событий: Различные действия пользователей, например, добавление товара в корзину, отправка данных формы заказа или закрытие модального окна, инициируются внутри компонентов. При этом компоненты используют метод `emit` для отправки событий с соответствующими данными.

3. Обработка событий: Другие компоненты, подписанные на эти события, получают уведомления. Например, компонент ViewBasket, подписанный на событие добавления товара в корзину, обновляет список выбранных товаров и общую стоимость. Компонент Order, подписанный на событие отправки формы заказа, обрабатывает полученные данные.
