# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание данных
Интерфейс ```IItemInit``` используется для получения данных с сервера. В поле ```total``` представлено общее количество элементов. В поле ```items``` представлен массив элементов.

```typescript
interface IItemInit {
    total: number;
    items: IItemCard[];
}
```
Интерфейс ```IItemCard``` хранит в себе данные о каждой карточке товара. В поле ```id``` хранится уникальный идентификатор товара. В поле ```description``` хранится краткое описание товара. В поле ```image``` хранится ссылка на изображение. В поле ```title``` хранится название товара. В поле ```category``` хранится категория товара. В поле ```price``` хранится цена товара.

```typescript
interface IItemCard {
    id: string;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number;
}
```
Интерфейс ```IBasket``` хранит в себе массив товаров (```itemCards```), добавленных в корзину. Метод ```addItemCard``` добавляет новый элемент в массив. Метод ```removeItemCard``` удаляет элемент из массива.

```typescript
interface IBasket {
    itemCards: IItemCard[];
    addItemCard: (item: IItemCard) => void;
    removeItemCard: (id: string) => void;
}
```
Интерфейс ```ICustomerSet``` хранит в себе данные о введённых покупателем данных. В поле ```paymentType``` хранится метод оплаты. В поле ```address``` хранится адрес. В поле ```email``` хранится электронная почта. В поле ```phone``` хранится номер телефона. Также интерфейс хранит в себе два метода. Метод ```setCustomerInfo``` принимает данные, которые указал покупатель. Метод ```checkValidation``` проверяет введённые данные на валидность.

```typescript
interface ICustomerSet {
    paymentType: string;
    address: string;
    email: string;
    phone: string;
    setCustomerInfo(customer: ICustomerSet): void;
    checkValidation(data: Record<keyof ICustomerSet, string>): boolean;
}
```
## Модели данных (Model)
Класс ```ItemInit``` будет реализовывать интерфейс ```IItemInit```. Данный класс нужен для работы с API запросом и получением от него количества элементов и массива карточек товаров.

Класс ```ItemCard``` будет реализовывать интерфейс ```IItemCard```. Данный класс будет использован для создания объекта карточки для каждого товара.

Класс ```Basket``` будет реализовывать интерфейс ```IBasket```. Данный класс будет использован для работы с корзиной (отображение и управление позициями в корзине).

Класс ```CustomerSet``` будет реализовывать интерфейс ```ICustomerSet```. Данный класс будет использован для работы с формой покупки.

## Компоненты представления (View)
Класс ```Modal```. Этот компонент отображает popup. В конструктор этого класса будет передаваться заполненный данными template для отрисовки popup с типом ```string``` и обработчик клика.

Класс ```Success```. Этот компонент отображает страницу успешного завершения покупки. В конструктор этого класса будет передаваться заполненный данными template для отрисовки страницы с типом ```string```.

Класс ```Card``` . Этот компонент отображает карточку. В конструктор этого класса будет передаваться заполненный данными template с типом ```string``` для отрисовки карточки и обработчик клика.

Класс ```Basket```. Этот компонент отображает страницу корзины. В конструктор этого класса будет передаваться заполненный данными template для отрисовки страницы с типом ```string``` и обработчик клика.

Класс ```Order```. Этот компонент отображает страницу оформления заказа. В конструктор этого класса будет передаваться заполненный данными template для отрисовки страницы с типом ```string``` и обработчик клика.

Класс ```Contacts```. Этот компонент отображает страницу для заполнения контактных данных. В конструктор этого класса будет передаваться заполненный данными template для отрисовки страницы с типом ```string``` и обработчик клика.

## Описание событий
Приложение реализует взаимодействие между слоями Model, View и Presenter с помощью системы событий. Для каждого пользовательского действия генерируется событие, которое проходит через Presenter, обновляет состояние Model и возвращает результат обратно во View.
### Список основных генерируемых событий:
1. ```card:select``` - событие, генерируемое при клике на карточку товара. Обрабатывается для показа всплывающего окна с деталями товара.
2. ```basket:add``` - событие, генерируемое при добавлении товара в корзину.
3. ```basket:remove``` - событие, генерируемое при удалении товара из корзины.
4. ```order:submit``` - событие, генерируемое при оформлении заказа. Событие отправляется в Model для валидации данных.
5. ```order:success``` - событие, указывающее на успешное завершение покупки.
6. ```preview:change``` - событие, генерируемое при изменении выбранного товара для показа его в модальном окне.
### Порядок генерации и обработки событий:
1. Клик по карточке товара:
   * Пользователь нажимает на карточку товара в галерее.
   * Класс ```Card```(View) вызывает событие ```card:select```, передавая данные о товаре.
   * Событие обрабатывается в Presenter(```EventEmitter```), который вызывает метод ```SetPreview``` у Model(```AppState```).
   * ```AppState``` обновляет состояние приложения и вызывает событие ```preview:change```, передавая обновлённые данные товара обратно в View.
   * Класс ```Modal```(View) получает событие ```preview:change``` и отрисовывает модальное окно с информацией о товаре. 
2. Добавление товара в корзину:
   * Пользователь нажимает кнопку "В корзину" в модальном окне.
   * Событие ```basket:add``` отправляется через Presenter, который вызывает метод ```addItemCard``` у Model(```Basket```).
   * ```Basket``` обновляет список товаров и генерирует событие ```basket:update```, которое передаётся обратно во View для обновления отображения корзины.
3. Оформление заказа:
   * Пользователь нажимает кнопку "Оформить" в корзине.
   * Событие ```order:submit``` отправляется в Presenter, который вызывает метод ```checkValidation``` у Model(```CustomerSet```).
   * Если данные валидны, генерируется событие ```order:success```, которое отображает страницу успешной покупки.